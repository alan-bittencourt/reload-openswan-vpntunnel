#!/bin/sh
DATAPATH="/sbin/scripts/restartvpn/databases"
CONF="/etc/ipsec.conf"
STR="vpn
DAEMON="/usr/sbin/ipsec"
BINGREP="/bin/grep"
BINAWK="/bin/awk"
BINWC="/usr/bin/wc"
BINHEAD="/usr/bin/head"
BINTAIL="/usr/bin/tail"
BINCUT="/bin/cut"
BINLOGGER="/bin/logger"
BINMUTT="/usr/bin/mutt"
BINDATE="/bin/date"
BINTOUCH="/bin/touch"
BINECHO="/bin/echo"
TAIL="$BINTAIL -1"
STRING="IPsec SA established"
UP=" auto --up "
ADD=" auto --add "
REMOVE=" auto --delete "
STATUS=" auto --status"
MUTT="$BINMUTT -s"
BODYFILE="$DATAPATH/body.txt"
BODYMANAGER="-i $MANAGERFILE"
MANAGERFILE=""
BODY="-i $BODYFILE"
MAILWARN="mail1"
MAILWARN1="mail1"
MAILWARN2="mail1"
DATABASEUPVPN="$DATAPATH/upvpns.list"
TEMPENLIST="$DATAPATH/tempenvpns.list"
DATABASEUPVPN="$DATAPATH/upvpns.list"
DATABASEENVPN="$DATAPATH/envpns.list"
LINEUPVPN="1"
LINEENVPN="1"
LIMITUPVPN=$($BINWC -l $DATABASEUPVPN | $BINAWK {'print $1'})
LIMITENVPN=$($BINWC -l $DATABASEENVPN | $BINAWK {'print $1'})
UPID=""
ENID=""
TEMPID=""
TEMPCONN=""
CHECK=""
TUNELUP="false"
MSGDOWN="DOWN nao obtive sucesso em reiniciar o Tunel"
PLUTOPID=""
FILEPLUTOPID="/var/run/pluto/pluto.pid"